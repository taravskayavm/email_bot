import os  # –ß–∏—Ç–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
from pathlib import Path  # –†–∞–±–æ—Ç–∞–µ–º —Å –ø—É—Ç—è–º–∏ –∫ —Ñ–∞–π–ª–∞–º –∏ –∫–∞—Ç–∞–ª–æ–≥–∞–º
from zoneinfo import ZoneInfo  # –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º —á–∞—Å–æ–≤—ã–µ –ø–æ—è—Å–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏
import pytz  # –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º pytz-—Ç–∞–π–º–∑–æ–Ω—É –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

from emailbot.runtime_config import get as rc_get  # –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏


def _int(name: str, default: int) -> int:
    """Read integer environment variables with graceful fallback."""

    try:
        raw = os.getenv(name, "")
        return int(raw.strip() or default)
    except Exception:
        return default


def _float(name: str, default: float) -> float:
    """Read float environment variables with graceful fallback."""

    try:
        raw = os.getenv(name, "")
        return float(raw.strip() or default)
    except Exception:
        return default


def _str(name: str, default: str) -> str:
    """Read string environment variables with stripping."""

    raw = os.getenv(name)
    if raw is None:
        return default
    raw = raw.strip()
    return raw if raw else default


def _env_bool(*keys: str, default: int = 0) -> int:  # –û–±—ä—è–≤–ª—è–µ–º —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π –ø–∞—Ä—Å–µ—Ä –±—É–ª–µ–≤—ã—Ö —Ñ–ª–∞–≥–æ–≤
    """Return 1/0 for the first present boolean environment variable."""  # –û–ø–∏—Å—ã–≤–∞–µ–º –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏

    for key in keys:  # –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º –≤–æ–∑–º–æ–∂–Ω—ã–µ –∏–º–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
        value = os.getenv(key)  # –°—á–∏—Ç—ã–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —Ç–µ–∫—É—â–µ–º—É –∫–ª—é—á—É
        if value is not None:  # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–∞–π–¥–µ–Ω–æ –ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ
            try:  # –ü—ã—Ç–∞–µ–º—Å—è –±–µ–∑–æ–ø–∞—Å–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –µ–≥–æ –∫ –±—É–ª–µ–≤–æ–º—É –≤–∏–¥—É
                normalized = str(value).strip().lower()  # –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º —Å—Ç—Ä–æ–∫—É –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É
                return 1 if normalized in {"1", "true", "on", "yes"} else 0  # –í–æ–∑–≤—Ä–∞—â–∞–µ–º 1 —Ç–æ–ª—å–∫–æ –¥–ª—è –∏—Å—Ç–∏–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
            except Exception:  # –û—Ç–ª–∞–≤–ª–∏–≤–∞–µ–º –ª—é–±—ã–µ –æ—à–∏–±–∫–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
                continue  # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å–ª–µ–¥—É—é—â–∏–π –∫–ª—é—á
    return default  # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –µ—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–¥–æ—à–ª–æ


def _env_str(*keys: str, default: str = "") -> str:  # –°–æ–∑–¥–∞—ë–º —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
    """Return the first present string environment variable without stripping semantics."""  # –î–∞—ë–º –ø–æ—è—Å–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏

    for key in keys:  # –ò—Ç–µ—Ä–∏—Ä—É–µ–º –ø–æ –≤—Å–µ–º –≤–æ–∑–º–æ–∂–Ω—ã–º –∏–º–µ–Ω–∞–º
        value = os.getenv(key)  # –°—á–∏—Ç—ã–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —Ç–µ–∫—É—â–µ–º—É –∫–ª—é—á—É
        if value is not None:  # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞
            return str(value)  # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—Ç—Ä–æ–∫–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
    return default  # –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –¥–µ—Ñ–æ–ª—Ç


def _env_int(*keys: str, default: int = 0) -> int:  # –í–≤–æ–¥–∏–º –ø–∞—Ä—Å–µ—Ä —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π —Å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å—é –∏–º—ë–Ω
    """Return the first present integer environment variable."""  # –û–ø–∏—Å—ã–≤–∞–µ–º —Ä–∞–±–æ—Ç—É —Ñ—É–Ω–∫—Ü–∏–∏

    for key in keys:  # –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º –¥–æ–ø—É—Å—Ç–∏–º—ã–µ –∫–ª—é—á–∏
        value = os.getenv(key)  # –ë–µ—Ä—ë–º –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è
        if value is not None:  # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –µ—Å—Ç—å
            try:  # –ü—Ä–æ–±—É–µ–º –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –∫ —Ü–µ–ª–æ–º—É —á–∏—Å–ª—É
                return int(value)  # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —É—Å–ø–µ—à–Ω–æ —Å–∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —á–∏—Å–ª–æ
            except Exception:  # –ü—Ä–∏ –æ—à–∏–±–∫–µ —Ä–∞–∑–±–æ—Ä–∞
                continue  # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å–ª–µ–¥—É—é—â–∏–π –∫–ª—é—á
    return default  # –ï—Å–ª–∏ –Ω–∏ –æ–¥–∏–Ω –∫–ª—é—á –Ω–µ –ø–æ–¥–æ—à—ë–ª, –æ—Ç–¥–∞—ë–º –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é


def _env_float(*keys: str, default: float = 0.0) -> float:  # –î–æ–±–∞–≤–ª—è–µ–º –ø–∞—Ä—Å–µ—Ä —á–∏—Å–µ–ª —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π
    """Return the first present float environment variable."""  # –ü–æ—è—Å–Ω—è–µ–º –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏

    for key in keys:  # –ò–¥—ë–º –ø–æ –≤—Å–µ–º –∫–∞–Ω–¥–∏–¥–∞—Ç–∞–º
        value = os.getenv(key)  # –°—á–∏—Ç—ã–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è
        if value is not None:  # –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
            try:  # –ü—Ä–æ–±—É–µ–º –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –µ–≥–æ –≤–æ float
                return float(value)  # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
            except Exception:  # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –Ω–µ—á–∏—Å–ª–æ–≤–æ–π –≤–≤–æ–¥
                continue  # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –∫–ª—é—á—É –ø—Ä–∏ –æ—à–∏–±–∫–µ
    return default  # –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –¥–µ—Ñ–æ–ª—Ç


_REPORT_TZ_RAW = os.getenv("REPORT_TZ", "Europe/Moscow")  # –ë–µ—Ä—ë–º –∏—Å—Ö–æ–¥–Ω—ã–π —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å
REPORT_TZ = _REPORT_TZ_RAW.strip() or "Europe/Moscow"  # –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ–º –Ω–µ–ø—É—Å—Ç–æ–π –∫–æ–¥ –ø–æ—è—Å–∞
try:
    REPORT_TZINFO = ZoneInfo(REPORT_TZ)  # –°–æ–∑–¥–∞—ë–º –æ–±—ä–µ–∫—Ç ZoneInfo –¥–ª—è –¥–∞—Ç
except Exception:  # pragma: no cover - –∑–∞—â–∏—Ç–Ω—ã–π –ø—É—Ç—å –ø—Ä–∏ –Ω–µ–≤–µ—Ä–Ω–æ–º –ø–æ—è—Å–µ
    REPORT_TZ = "Europe/Moscow"  # –°–±—Ä–∞—Å—ã–≤–∞–µ–º—Å—è –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å –ø—Ä–∏ –æ—à–∏–±–∫–µ
    REPORT_TZINFO = ZoneInfo(REPORT_TZ)  # –ü–µ—Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç–∞–π–º–∑–æ–Ω—É –ø–æ—Å–ª–µ –æ—Ç–∫–∞—Ç–∞

try:  # –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º pytz-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π –æ–±—ä–µ–∫—Ç –¥–ª—è —Å—Ç–∞—Ä—ã—Ö —É—á–∞—Å—Ç–∫–æ–≤ –∫–æ–¥–∞
    TIMEZONE = pytz.timezone(REPORT_TZ)  # –°–æ–∑–¥–∞—ë–º pytz-—Ç–∞–π–º–∑–æ–Ω—É –ø–æ –∞–∫—Ç—É–∞–ª—å–Ω–æ–º—É –∫–æ–¥—É –ø–æ—è—Å–∞
except Exception:  # pragma: no cover - fallback –ø—Ä–∏ –æ—à–∏–±–∫–µ –≤–Ω—É—Ç—Ä–∏ pytz
    TIMEZONE = pytz.timezone("Europe/Moscow")  # –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º—É pytz-–ø–æ—è—Å—É –ø—Ä–∏ —Å–±–æ–µ

HISTORY_DB = (  # –ì–ª–∞–≤–Ω–∞—è –±–∞–∑–∞ –∏—Å—Ç–æ—Ä–∏–∏ –æ—Ç–ø—Ä–∞–≤–æ–∫
    os.getenv("HISTORY_DB", "var/send_history.db").strip() or "var/send_history.db"
)  # –ë–µ—Ä—ë–º –ø—É—Ç—å –∏–∑ –æ–∫—Ä—É–∂–µ–Ω–∏—è –ª–∏–±–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç
SENT_LOG_PATH = (  # –û—Å–Ω–æ–≤–Ω–æ–π CSV —Å –æ—Ç–ø—Ä–∞–≤–∫–∞–º–∏
    os.getenv("SENT_LOG_PATH", "var/sent_log.csv").strip() or "var/sent_log.csv"
)  # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Ç—å –∫ sent_log.csv –∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –æ–∫—Ä—É–∂–µ–Ω–∏—è
AUDIT_DIR = os.getenv("AUDIT_DIR", "var").strip() or "var"  # –ö–∞—Ç–∞–ª–æ–≥ —Å –∞—É–¥–∏—Ç-–ª–æ–≥–∞–º–∏


SEND_COOLDOWN_DAYS = int(os.getenv("SEND_COOLDOWN_DAYS", "180"))
SEND_STATS_PATH = os.getenv("SEND_STATS_PATH", "var/send_stats.jsonl")
DOMAIN_RATE_LIMIT_SEC = float(os.getenv("DOMAIN_RATE_LIMIT_SEC", "1.0"))
APPEND_TO_SENT = int(os.getenv("APPEND_TO_SENT", "1")) == 1
CRAWL_MAX_PAGES = int(os.getenv("CRAWL_MAX_PAGES", "120"))
CRAWL_MAX_DEPTH = int(os.getenv("CRAWL_MAX_DEPTH", "3"))
CRAWL_SAME_DOMAIN = os.getenv("CRAWL_SAME_DOMAIN", "1") == "1"
CRAWL_DELAY_SEC = float(os.getenv("CRAWL_DELAY_SEC", "0.5"))
CRAWL_USER_AGENT = os.getenv(
    "CRAWL_USER_AGENT", "EmailBotCrawler/1.0 (+contact@example.com)"
)  # –ó–∞–≤–µ—Ä—à–∞–µ–º –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ user-agent –¥–ª—è –∫—Ä–∞—É–ª–µ—Ä–∞
CRAWL_HTTP2 = os.getenv("CRAWL_HTTP2", "1") == "1"
CRAWL_MAX_PAGES_PER_DOMAIN = int(os.getenv("CRAWL_MAX_PAGES_PER_DOMAIN", "50"))
CRAWL_TIME_BUDGET_SECONDS = int(os.getenv("CRAWL_TIME_BUDGET_SECONDS", "120"))
ROBOTS_CACHE_PATH = os.getenv("ROBOTS_CACHE_PATH", "var/robots_cache.json")
ROBOTS_CACHE_TTL_SECONDS = int(os.getenv("ROBOTS_CACHE_TTL_SECONDS", "86400"))

# UX: —Ä–∞–∑—Ä–µ—à–∞—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞?
ALLOW_EDIT_AT_PREVIEW = os.getenv("ALLOW_EDIT_AT_PREVIEW", "0") == "1"

# –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ (–∏–Ω–ª–∞–π–Ω) —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ e-mail –≤ –±–æ—Ç–µ
ENABLE_INLINE_EMAIL_EDITOR = os.getenv("ENABLE_INLINE_EMAIL_EDITOR", "0") == "1"

# PDF extraction tuning
PDF_ENGINE = _str("EMAILBOT_PDF_ENGINE", "fitz")  # –í—ã–±–∏—Ä–∞–µ–º –¥–≤–∏–∂–æ–∫ PDF –∏–∑ –æ–∫—Ä—É–∂–µ–Ω–∏—è
PDF_MAX_PAGES = rc_get(  # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ª–∏–º–∏—Ç —Å—Ç—Ä–∞–Ω–∏—Ü –ø—Ä–∏ –ø—Ä—è–º–æ–º —á—Ç–µ–Ω–∏–∏ PDF
    "PDF_MAX_PAGES",  # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–ª—é—á runtime-–∫–æ–Ω—Ñ–∏–≥–∞
    _env_int("PDF_MAX_PAGES", "PDF_PAGE_LIMIT", default=40),  # –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –∏–º–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è
)  # –ó–∞–¥–∞—ë–º –ª–∏–º–∏—Ç —Å—Ç—Ä–∞–Ω–∏—Ü –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
# –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–∞–π–º–∞—É—Ç –æ—Å—Ç–∞—ë—Ç—Å—è –∫–∞–∫ —Ä–µ–∑–µ—Ä–≤–Ω—ã–π (–µ—Å–ª–∏ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –≤—ã–∫–ª—é—á–µ–Ω)
PDF_EXTRACT_TIMEOUT = rc_get(
    "PDF_EXTRACT_TIMEOUT", _int("PDF_EXTRACT_TIMEOUT", 25)
)  # seconds
PDF_PAGE_TIMEOUT_SEC = rc_get(  # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –æ–¥–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    "PDF_PAGE_TIMEOUT_SEC",  # –ë–µ—Ä—ë–º –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ runtime-–∫–æ–Ω—Ñ–∏–≥–∞
    _env_float("PDF_PAGE_TIMEOUT_SEC", default=8.0),  # –ß–∏—Ç–∞–µ–º –¥–µ—Ñ–æ–ª—Ç –∏–∑ –æ–∫—Ä—É–∂–µ–Ω–∏—è —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π
)  # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–∞–π–º-–∞—É—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã PDF –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
PDF_FAST_LIMIT_PAGES = rc_get(  # –í–≤–æ–¥–∏–º –º—è–≥–∫–∏–π –ø—Ä–µ–¥–µ–ª —Å—Ç—Ä–∞–Ω–∏—Ü –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è
    "PDF_FAST_LIMIT_PAGES",  # –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –∫–ª—é—á –≤ runtime-–∫–æ–Ω—Ñ–∏–≥–µ
    _env_int("PDF_FAST_LIMIT_PAGES", default=200),  # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã–π –¥–µ—Ñ–æ–ª—Ç –∏–∑ –æ–∫—Ä—É–∂–µ–Ω–∏—è
)  # –§–∏–∫—Å–∏—Ä—É–µ–º –ª–∏–º–∏—Ç —Å—Ç—Ä–∞–Ω–∏—Ü –≤ –±—ã—Å—Ç—Ä–æ–º –ø—Ä–æ—Ñ–∏–ª–µ
PDF_PROFILE = rc_get(  # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ PDF
    "PDF_PROFILE",  # –û–±—Ä–∞—â–∞–µ–º—Å—è –∫ runtime-–∫–æ–Ω—Ñ–∏–≥–∞ –ø–æ –∫–ª—é—á—É –ø—Ä–æ—Ñ–∏–ª—è
    (_str("PDF_PROFILE", "fast") or "fast").strip().lower(),  # –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º —Å—Ç—Ä–æ–∫—É –∏–∑ –æ–∫—Ä—É–∂–µ–Ω–∏—è —Å –¥–µ—Ñ–æ–ª—Ç–æ–º fast
)  # –•—Ä–∞–Ω–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è
if PDF_PROFILE not in {"fast", "full"}:  # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è
    PDF_PROFILE = "fast"  # –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º—É –ø—Ä–æ—Ñ–∏–ª—é fast –ø—Ä–∏ –æ—à–∏–±–∫–µ
PDF_FOUND_TARGET = rc_get(  # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —á–∏—Å–ª–æ –∞–¥—Ä–µ—Å–æ–≤, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ –¥–ª—è —Ä–∞–Ω–Ω–µ–≥–æ –≤—ã—Ö–æ–¥–∞
    "PDF_FOUND_TARGET",  # –°—á–∏—Ç—ã–≤–∞–µ–º –∫–ª—é—á –∏–∑ runtime-–∫–æ–Ω—Ñ–∏–≥–∞
    _env_int("PDF_FOUND_TARGET", default=20),  # –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫—É —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
)  # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ü–µ–ª–µ–≤–æ–π –ø–æ—Ä–æ–≥ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤
PDF_SCAN_SAMPLE = rc_get(  # –£–ø—Ä–∞–≤–ª—è–µ–º –≤–∫–ª—é—á–µ–Ω–∏–µ–º –≤—ã–±–æ—Ä–æ—á–Ω–æ–≥–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
    "PDF_SCAN_SAMPLE",  # –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–ª—é—á –¥–ª—è runtime-–∫–æ–Ω—Ñ–∏–≥–∞
    _env_int("PDF_SCAN_SAMPLE", default=1),  # –ß–∏—Ç–∞–µ–º —Ñ–ª–∞–≥ –≤—ã–±–æ—Ä–æ—á–Ω–æ–≥–æ –æ–±—Ö–æ–¥–∞ –∏–∑ –æ–∫—Ä—É–∂–µ–Ω–∏—è
)  # –•—Ä–∞–Ω–∏–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –≤—ã–±–æ—Ä–æ—á–Ω–æ–≥–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü
PDF_SCAN_STRIDE = rc_get(  # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —à–∞–≥ –≤—ã–±–æ—Ä–æ—á–Ω–æ–≥–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
    "PDF_SCAN_STRIDE",  # –ó–∞–ø–æ–º–∏–Ω–∞–µ–º –∫–ª—é—á –≤ runtime-–∫–æ–Ω—Ñ–∏–≥–µ
    max(1, _env_int("PDF_SCAN_STRIDE", default=5)),  # –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π —à–∞–≥, —Å—á–∏—Ç–∞–Ω–Ω—ã–π –∏–∑ –æ–∫—Ä—É–∂–µ–Ω–∏—è
)  # –°–æ—Ö—Ä–∞–Ω—è–µ–º —à–∞–≥ —á–µ—Ä–µ–∑ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü
PDF_STOP_AFTER_NO_HITS = rc_get(  # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ª–∏–º–∏—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
    "PDF_STOP_AFTER_NO_HITS",  # –û–±—ä—è–≤–ª—è–µ–º –∫–ª—é—á runtime-–∫–æ–Ω—Ñ–∏–≥–∞
    _env_int("PDF_STOP_AFTER_NO_HITS", default=12),  # –ë–µ—Ä—ë–º –¥–µ—Ñ–æ–ª—Ç –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è
)  # –ó–∞–≤–µ—Ä—à–∞–µ–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ—Ä–æ–≥–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–æ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—é –Ω–∞—Ö–æ–¥–æ–∫
_ENABLE_OCR_DEFAULT = _env_bool(  # –§–æ—Ä–º–∏—Ä—É–µ–º –¥–µ—Ñ–æ–ª—Ç –¥–ª—è OCR –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
    "ENABLE_OCR",  # –£—á–∏—Ç—ã–≤–∞–µ–º –Ω–æ–≤–æ–µ –æ–±—â–µ–µ –∏–º—è —Ñ–ª–∞–≥–∞
    "EMAILBOT_ENABLE_OCR",  # –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É —Å—Ç–∞—Ä–æ–≥–æ —Ñ–ª–∞–≥–∞ –±–æ—Ç–∞
    "PDF_OCR_AUTO",  # –î–æ–±–∞–≤–ª—è–µ–º –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –∫–ª—é—á –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ OCR
    default=_int("PDF_OCR_AUTO", 1),  # –ü–∞–¥–∞–µ–º –Ω–∞–∑–∞–¥ –Ω–∞ —Å—Ç–∞—Ä—ã–π –¥–µ—Ñ–æ–ª—Ç –∏–∑ –æ–∫—Ä—É–∂–µ–Ω–∏—è
)  # –ó–∞–≤–µ—Ä—à–∞–µ–º —Å–±–æ—Ä –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ –≤—Å–µ–º —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–º –∫–ª—é—á–∞–º OCR
EMAILBOT_ENABLE_OCR = rc_get(  # –û–±–Ω–æ–≤–ª—è–µ–º —Ñ–ª–∞–≥ –≤–∫–ª—é—á–µ–Ω–∏—è OCR –≤ runtime-–∫–æ–Ω—Ñ–∏–≥–µ
    "EMAILBOT_ENABLE_OCR",  # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞—Ä–æ–µ –∏–º—è –∫–ª—é—á–∞ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
    bool(_ENABLE_OCR_DEFAULT),  # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —á–∏—Å–ª–æ–≤–æ–π —Ñ–ª–∞–≥ –≤ –±—É–ª–µ–≤–æ –∑–Ω–∞—á–µ–Ω–∏–µ
)  # –§–∏–∫—Å–∏—Ä—É–µ–º –±—É–ª–µ–≤—ã–π –ø—Ä–∏–∑–Ω–∞–∫ –≤–∫–ª—é—á—ë–Ω–Ω–æ–≥–æ OCR –≤ runtime-–∫–æ–Ω—Ñ–∏–≥–µ
ENABLE_OCR = rc_get(  # –î–∞—ë–º –Ω–æ–≤–æ–µ –∏–º—è –ø–∞—Ä–∞–º–µ—Ç—Ä—É –¥–ª—è —è–≤–Ω–æ–≥–æ –≤–∫–ª—é—á–µ–Ω–∏—è OCR
    "ENABLE_OCR",  # –§–∏–∫—Å–∏—Ä—É–µ–º –∫–ª—é—á –¥–ª—è runtime-–∫–æ–Ω—Ñ–∏–≥–∞
    EMAILBOT_ENABLE_OCR,  # –ü–µ—Ä–µ–Ω–æ—Å–∏–º –≤—ã—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
)  # –û–±—ä—è–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–π —Ñ–ª–∞–≥ ENABLE_OCR —Å —É—á—ë—Ç–æ–º runtime-–∫–æ–Ω—Ñ–∏–≥–∞
# -------- PDF / OCR Auto Mode --------
PDF_OCR_AUTO = rc_get(  # –ó–∞–≥—Ä—É–∂–∞–µ–º —Ä–µ–∂–∏–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–±–æ—Ä–∞ OCR
    "PDF_OCR_AUTO",  # –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–ª—é—á PDF_OCR_AUTO –≤ runtime-–∫–æ–Ω—Ñ–∏–≥–µ
    _ENABLE_OCR_DEFAULT,  # –ü–µ—Ä–µ–¥–∞—ë–º –¥–µ—Ñ–æ–ª—Ç, —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π —Å –Ω–æ–≤—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è
)  # –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ–º –∏—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∂–∏–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ OCR
PDF_OCR_PROBE_PAGES = rc_get(  # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü –¥–ª—è –ø–µ—Ä–≤–∏—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–µ–∫—Å—Ç–∞
    "PDF_OCR_PROBE_PAGES",  # –û–±—Ä–∞—â–∞–µ–º—Å—è –∫ runtime-–∫–æ–Ω—Ñ–∏–≥—É –ø–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º—É –∫–ª—é—á—É
    _env_int("PDF_OCR_PROBE_PAGES", "OCR_PROBE_PAGES", default=5),  # –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ –∏–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
)  # –°–æ—Ö—Ä–∞–Ω—è–µ–º –ª–∏–º–∏—Ç —Å—Ç—Ä–∞–Ω–∏—Ü –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø—Ä–æ–≥–æ–Ω–∞ –ø–µ—Ä–µ–¥ OCR
PDF_OCR_MAX_PAGES = rc_get(  # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –º–∞–∫—Å–∏–º—É–º —Å—Ç—Ä–∞–Ω–∏—Ü, –∫–æ—Ç–æ—Ä—ã–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ OCR
    "PDF_OCR_MAX_PAGES",  # –°—á–∏—Ç—ã–≤–∞–µ–º –∫–ª—é—á –∏–∑ runtime-–∫–æ–Ω—Ñ–∏–≥–∞
    _env_int("PDF_OCR_MAX_PAGES", "OCR_MAX_PAGES", default=300),  # –£—á–∏—Ç—ã–≤–∞–µ–º –Ω–æ–≤–æ–µ –∏ —Å—Ç–∞—Ä–æ–µ –∏–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è
)  # –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ–º –∏—Ç–æ–≥–æ–≤—ã–π –ª–∏–º–∏—Ç —Å—Ç—Ä–∞–Ω–∏—Ü –¥–ª—è OCR-–ø—Ä–æ—Ö–æ–¥–∞
PDF_OCR_MIN_TEXT_RATIO = rc_get(  # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –¥–æ–ª—é —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
    "PDF_OCR_MIN_TEXT_RATIO",  # –ó–∞–±–∏—Ä–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ runtime-–∫–æ–Ω—Ñ–∏–≥–∞
    _env_float("PDF_OCR_MIN_TEXT_RATIO", "OCR_MIN_TEXT_RATIO", default=0.05),  # –ë–µ—Ä—ë–º –¥–µ—Ñ–æ–ª—Ç –∏–∑ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
)  # –ó–∞–≤–µ—Ä—à–∞–µ–º —á—Ç–µ–Ω–∏–µ –ø–æ—Ä–æ–≥–∞ –¥–æ–ª–∏ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ
PDF_OCR_MIN_CHARS = rc_get(  # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º–≤–æ–ª–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
    "PDF_OCR_MIN_CHARS",  # –ß–∏—Ç–∞–µ–º –∫–ª—é—á –∏–∑ runtime-–∫–æ–Ω—Ñ–∏–≥–∞
    _env_int("PDF_OCR_MIN_CHARS", "OCR_MIN_CHARS", default=150),  # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –æ–±–∞ –∏–º–µ–Ω–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è
)  # –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ–º –ø–æ—Ä–æ–≥ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–∏–º–≤–æ–ª–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
TESSERACT_CMD = os.getenv("TESSERACT_CMD", "").strip()  # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π –ø—É—Ç—å –∫ Tesseract
OCR_TESSERACT_CMD = rc_get(  # –ü–µ—Ä–µ—ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º –ø—É—Ç—å –∫ tesseract –ø–æ–¥ –Ω–æ–≤—ã–º –∏–º–µ–Ω–µ–º
    "OCR_TESSERACT_CMD",  # –ò—Å–ø–æ–ª—å–∑—É–µ–º —è–≤–Ω—ã–π –∫–ª—é—á –≤ runtime-–∫–æ–Ω—Ñ–∏–≥–µ
    _env_str("OCR_TESSERACT_CMD", "TESSERACT_CMD", default=TESSERACT_CMD),  # –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º –æ–±–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è
)  # –ó–∞–≤–µ—Ä—à–∞–µ–º —ç–∫—Å–ø–æ—Ä—Ç –ø—É—Ç–∏ –∫ tesseract –≤ runtime-–∫–æ–Ω—Ñ–∏–≥

# -------- –†–∞–Ω–Ω–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å / —Ç—ë–ø–ª—ã–π —Å—Ç–∞—Ä—Ç --------
PDF_WARMUP_PAGES = rc_get(  # –ë–µ—Ä—ë–º —á–∏—Å–ª–æ —Å—Ç—Ä–∞–Ω–∏—Ü –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø—Ä–æ–≥—Ä–µ–≤–∞, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —á–µ—Ç—ã—Ä–µ
    "PDF_WARMUP_PAGES",  # –ü–µ—Ä–µ–¥–∞—ë–º –∫–ª—é—á –ø–∞—Ä–∞–º–µ—Ç—Ä–∞, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤ runtime
    _int("PDF_WARMUP_PAGES", 4),  # –°—á–∏—Ç—ã–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –æ–∫—Ä—É–∂–µ–Ω–∏—è —Å –¥–µ—Ñ–æ–ª—Ç–æ–º 4 —Å—Ç—Ä–∞–Ω–∏—Ü—ã
)
PDF_EARLY_HEARTBEAT_SEC = rc_get(  # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–æ–ª—á–∞–Ω–∏—è –ø–µ—Ä–µ–¥ —Ä–∞–Ω–Ω–∏–º heartbeat
    "PDF_EARLY_HEARTBEAT_SEC",  # –ò—Å–ø–æ–ª—å–∑—É–µ–º —á–∏—Ç–∞–µ–º—ã–π –∫–ª—é—á –¥–ª—è runtime-–∫–æ–Ω—Ñ–∏–≥–∞
    _float("PDF_EARLY_HEARTBEAT_SEC", 2.5),  # –ë–µ—Ä—ë–º –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –æ–∫—Ä—É–∂–µ–Ω–∏—è, –¥–µ—Ñ–æ–ª—Ç 2.5 —Å–µ–∫—É–Ω–¥—ã
)
PDF_WARMUP_MIN_FOUND = rc_get(  # –§–∏–∫—Å–∏—Ä—É–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ email –ø–æ—Å–ª–µ warmup
    "PDF_WARMUP_MIN_FOUND",  # –û–±—ä—è–≤–ª—è–µ–º –∫–ª—é—á –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
    _int("PDF_WARMUP_MIN_FOUND", 1),  # –°—á–∏—Ç—ã–≤–∞–µ–º –ø–æ—Ä–æ–≥ –∏–∑ –æ–∫—Ä—É–∂–µ–Ω–∏—è, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –∞–¥—Ä–µ—Å
)

# -------- OCR / PDF unified knobs --------
PDF_BACKEND = rc_get(
    "PDF_BACKEND",
    (_str("PDF_BACKEND", PDF_ENGINE) or PDF_ENGINE).strip().lower(),
)
if PDF_BACKEND not in {"fitz", "pdfminer", "auto"}:
    PDF_BACKEND = "fitz"

PDF_LEGACY_MODE = rc_get("PDF_LEGACY_MODE", _int("LEGACY_MODE", 0) == 1)
PDF_FAST_MIN_HITS = rc_get("PDF_FAST_MIN_HITS", _int("PDF_FAST_MIN_HITS", 8))
PDF_FAST_TIMEOUT_MS = rc_get("PDF_FAST_TIMEOUT_MS", _int("PDF_FAST_TIMEOUT_MS", 60))
PDF_TEXT_TRUNCATE_LIMIT = rc_get(
    "PDF_TEXT_TRUNCATE_LIMIT", _int("PDF_TEXT_TRUNCATE_LIMIT", 2_000_000)
)

PDF_OCR_ENGINE = rc_get(  # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–≤–∏–∂–æ–∫ OCR —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö –∏–º—ë–Ω
    "PDF_OCR_ENGINE",  # –ö–ª—é—á runtime-–∫–æ–Ω—Ñ–∏–≥–∞ –¥–ª—è –¥–≤–∏–∂–∫–∞ OCR
    _str("PDF_OCR_ENGINE", _str("OCR_ENGINE", "pytesseract")),  # –û–±—ä–µ–¥–∏–Ω—è–µ–º –Ω–æ–≤—ã–µ –∏ —Å—Ç–∞—Ä—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
)  # –ó–∞–≤–µ—Ä—à–∞–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–≤–∏–∂–∫–∞ OCR —Å —É—á—ë—Ç–æ–º —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
PDF_OCR_LANG = rc_get(  # –£–∫–∞–∑—ã–≤–∞–µ–º —è–∑—ã–∫–∏ OCR —Å —É—á—ë—Ç–æ–º —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
    "PDF_OCR_LANG",  # –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–ª—é—á runtime-–∫–æ–Ω—Ñ–∏–≥–∞ –¥–ª—è —Å–ø–∏—Å–∫–∞ —è–∑—ã–∫–æ–≤
    _str("PDF_OCR_LANG", _str("OCR_LANG", "eng+rus")),  # –°—á–∏—Ç–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –≤—Å–µ—Ö –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
)  # –§–∏–∫—Å–∏—Ä—É–µ–º –Ω–∞–±–æ—Ä —è–∑—ã–∫–æ–≤ OCR –≤ runtime-–∫–æ–Ω—Ñ–∏–≥–µ
OCR_ENGINE = rc_get(  # –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º —Å–æ–∫—Ä–∞—â—ë–Ω–Ω–æ–µ –∏–º—è –¥–≤–∏–∂–∫–∞ OCR
    "OCR_ENGINE",  # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–ª—é—á –≤ runtime-–∫–æ–Ω—Ñ–∏–≥–µ
    PDF_OCR_ENGINE,  # –ü–µ—Ä–µ–Ω–æ—Å–∏–º —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–π —Ä–∞–Ω–µ–µ –¥–µ—Ñ–æ–ª—Ç
)  # –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º —Å–∏–Ω–æ–Ω–∏–º–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –¥–≤–∏–∂–∫—É OCR
OCR_LANG = rc_get(  # –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º —Å–æ–∫—Ä–∞—â—ë–Ω–Ω–æ–µ –∏–º—è —Å–ø–∏—Å–∫–∞ —è–∑—ã–∫–æ–≤
    "OCR_LANG",  # –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –∫–ª—é—á –≤ runtime-–∫–æ–Ω—Ñ–∏–≥–µ
    PDF_OCR_LANG,  # –ò—Å–ø–æ–ª—å–∑—É–µ–º –±–∞–∑–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ–≥–æ –±–ª–æ–∫–∞
)  # –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º —è–∑—ã–∫–æ–≤–æ–π –Ω–∞–±–æ—Ä OCR –ø–æ–¥ —É–∫–æ—Ä–æ—á–µ–Ω–Ω—ã–º –∏–º–µ–Ω–µ–º
PDF_OCR_PAGE_LIMIT = rc_get(  # –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º –ª–∏–º–∏—Ç —Å—Ç—Ä–∞–Ω–∏—Ü –≤ OCR-–ø–æ—Ç–æ–∫–µ
    "PDF_OCR_PAGE_LIMIT",  # –ß–∏—Ç–∞–µ–º –∫–ª—é—á runtime-–∫–æ–Ω—Ñ–∏–≥–∞
    _env_int(  # –°–ª–∏–≤–∞–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
        "PDF_OCR_PAGE_LIMIT",  # –û—Å–Ω–æ–≤–Ω–æ–µ –∏–º—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
        "OCR_PAGE_LIMIT",  # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ –∏–º—è –æ–∫—Ä—É–∂–µ–Ω–∏—è
        default=PDF_OCR_MAX_PAGES if PDF_OCR_MAX_PAGES > 0 else 10,  # –ò—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç, —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–π —Å –æ–±—â–∏–º –ª–∏–º–∏—Ç–æ–º
    ),
)  # –£—Ç–≤–µ—Ä–∂–¥–∞–µ–º –ª–∏–º–∏—Ç —Å—Ç—Ä–∞–Ω–∏—Ü, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ –≥–æ–Ω—è—Ç—å —á–µ—Ä–µ–∑ OCR
PDF_OCR_TIME_LIMIT = rc_get(  # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—â–∏–π —Ç–∞–π–º-–∞—É—Ç –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏—é OCR
    "PDF_OCR_TIME_LIMIT",  # –ë–µ—Ä—ë–º –∫–ª—é—á runtime-–∫–æ–Ω—Ñ–∏–≥–∞
    _env_int("PDF_OCR_TIME_LIMIT", "OCR_TIME_LIMIT", default=30),  # –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º —Å—Ç–∞—Ä—ã–µ –∏ –Ω–æ–≤—ã–µ –∏–º–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
)  # –§–∏–∫—Å–∏—Ä—É–µ–º —Å—É–º–º–∞—Ä–Ω—ã–π —Ç–∞–π–º-–∞—É—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è OCR
PDF_OCR_TIMEOUT_PER_PAGE = rc_get(  # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Ç–∞–π–º-–∞—É—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø—Ä–∏ OCR
    "PDF_OCR_TIMEOUT_PER_PAGE",  # –ß–∏—Ç–∞–µ–º –∫–ª—é—á runtime-–∫–æ–Ω—Ñ–∏–≥–∞
    _env_int("PDF_OCR_TIMEOUT_PER_PAGE", "OCR_TIMEOUT_PER_PAGE", default=20),  # –°–≤–æ–¥–∏–º –≤—Å–µ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
)  # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±—é–¥–∂–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –æ–¥–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
PDF_OCR_DPI = rc_get(  # –û–ø—Ä–µ–¥–µ–ª—è–µ–º DPI —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ —Å—Ç—Ä–∞–Ω–∏—Ü –¥–ª—è OCR
    "PDF_OCR_DPI",  # –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–ª—é—á runtime-–∫–æ–Ω—Ñ–∏–≥–∞
    _env_int("PDF_OCR_DPI", "OCR_DPI", default=300),  # –ü—Ä–∏–Ω–∏–º–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
)  # –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ —Ä–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–µ—Ä–µ–¥ OCR
PDF_OCR_CACHE_DIR = rc_get(
    "PDF_OCR_CACHE_DIR",
    str(Path(_str("PDF_OCR_CACHE_DIR", _str("OCR_CACHE_DIR", "var/ocr_cache")))).strip(),
)
PDF_OCR_ALLOW_BEST_EFFORT = rc_get(
    "PDF_OCR_ALLOW_BEST_EFFORT",
    _int("PDF_OCR_ALLOW_BEST_EFFORT", 1) == 1,
)
PDF_FORCE_OCR_IF_FOUND_LT = rc_get(
    "PDF_FORCE_OCR_IF_FOUND_LT", _int("PDF_FORCE_OCR_IF_FOUND_LT", 25)
)


# -------- PDF Open Guard / Fallback --------
PDF_OPEN_TIMEOUT_SEC = rc_get(
    "PDF_OPEN_TIMEOUT_SEC",
    _int("PDF_OPEN_TIMEOUT_SEC", 10),
)
PDF_FALLBACK_BACKEND = rc_get(
    "PDF_FALLBACK_BACKEND",
    os.getenv("PDF_FALLBACK_BACKEND", "pdfminer"),
)

# üìà –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π —Ç–∞–π–º–∞—É—Ç (–≤–∫–ª—é—á—ë–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
PDF_ADAPTIVE_TIMEOUT = rc_get("PDF_ADAPTIVE_TIMEOUT", os.getenv("PDF_ADAPTIVE_TIMEOUT", "1") == "1")
# –±–∞–∑–æ–≤–∞—è —á–∞—Å—Ç—å —Ç–∞–π–º–∞—É—Ç–∞, —Å–µ–∫
PDF_TIMEOUT_BASE = rc_get("PDF_TIMEOUT_BASE", _int("PDF_TIMEOUT_BASE", 15))
# –¥–æ–±–∞–≤–∫–∞ –∑–∞ –∫–∞–∂–¥—ã–π –º–µ–≥–∞–±–∞–π—Ç, —Å–µ–∫/–ú–ë
PDF_TIMEOUT_PER_MB = rc_get("PDF_TIMEOUT_PER_MB", _float("PDF_TIMEOUT_PER_MB", 0.6))
# –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–µ–¥–µ–ª—ã, —Å–µ–∫
PDF_TIMEOUT_MIN = rc_get("PDF_TIMEOUT_MIN", _int("PDF_TIMEOUT_MIN", 15))
PDF_TIMEOUT_MAX = rc_get("PDF_TIMEOUT_MAX", _int("PDF_TIMEOUT_MAX", 90))

# -------- –ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ --------
# –ï—Å–ª–∏ 1 ‚Äî –ø–∞—Ä—Å–∏–º –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã PDF (–±–µ–∑ —Ä–∞–Ω–Ω–µ–≥–æ –≤—ã—Ö–æ–¥–∞ –ø–æ "–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∞–¥—Ä–µ—Å–æ–≤")
PARSE_COLLECT_ALL = rc_get("PARSE_COLLECT_ALL", _int("PARSE_COLLECT_ALL", 1))

# –ß–∞—Å—Ç–æ—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –≤ Telegram
PROGRESS_UPDATE_EVERY_PAGES = rc_get(
    "PROGRESS_UPDATE_EVERY_PAGES", _int("PROGRESS_UPDATE_EVERY_PAGES", 10)
)
PROGRESS_UPDATE_MIN_SEC = rc_get(
    "PROGRESS_UPDATE_MIN_SEC", _float("PROGRESS_UPDATE_MIN_SEC", 2.0)
)
